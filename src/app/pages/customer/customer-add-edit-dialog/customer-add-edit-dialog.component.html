<div class="card">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" (click)="closeModal()"><span>&times;</span></button>
            <h4 class="modal-title">{{customerID > 0 ? 'Cập nhật khách hàng' : 'Thêm mới khách hàng'}}
            </h4>
        </div>
        <div class="modal-body">
            <form [formGroup]="formData">
                <div *ngIf="isMinimized">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Tên khách hàng<span
                                                class="text-danger">*</span></label>
                                        <div class="col-sm-8">
                                            <input formControlName="tenNhomKhachHang"
                                                class="form-control mb-0 text-left" type="text" />
                                            <span class="text-danger field-validation-error"
                                                *ngIf="formData.get('tenKhachHang')?.invalid && formData.get('tenKhachHang')?.touched">
                                                Chưa nhập tên khách hàng!
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Nhóm khách hàng <span
                                                class="text-danger">*</span></label>
                                        <div class="col-sm-8">
                                            <select formControlName="maNhomKhachHang"
                                                class="form-control mb-0 ng-pristine ng-valid ng-touched">
                                                <option *ngFor="let item of listNhomKhachHang;" value="{{item.id}}">
                                                    {{item.tenNhomKhachHang}}</option>
                                            </select>
                                            <span class="text-danger field-validation-error"
                                                *ngIf="formData.get('maNhomKhachHang')?.invalid && formData.get('maNhomKhachHang')?.touched">
                                                Chưa chọn nhóm khách hàng!
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Kiểu khách hàng</label>
                                        <div class="col-sm-8">
                                            <select class="form-control mb-0 ng-pristine ng-valid ng-touched"
                                                formControlName="cusType">
                                                <option value="">Chọn loại khách hàng</option>
                                                <option selected="" value="false">Cá nhân</option>
                                                <option value="true">Tổ chức</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Giới tính</label>
                                        <div class="col-sm-8">
                                            <select class="form-control mb-0 ng-pristine ng-untouched ng-valid"
                                                formControlName="sexId">
                                                <option value="">--Chọn giới tính--</option>
                                                <option value="0">Nam</option>
                                                <option value="1">Nữ</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <!-- Tổ chức -->
                                <div class="col-md-6 form-group ng-hide">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã số thuế</label>
                                        <div class="col-sm-8">
                                            <input formControlName="taxCode" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Ngày sinh</label>
                                        <div class="col-sm-8">
                                            <input formControlName="birthDate" class="form-control mb-0 text-left"
                                                type="date" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Tuổi</label>
                                        <div class="col-sm-8">
                                            <input formControlName="tuoiKhacHang" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Số điện thoại</label>
                                        <div class="col-sm-8">
                                            <input formControlName="soDienThoai" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Địa chỉ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="diaChi" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã vạch</label>
                                        <div class="col-sm-8">
                                            <div class="input-group">
                                                <input class="form-control mb-0" style="text-align:left" type="text"
                                                    formControlName="barcode" />
                                                <div class="input-group-btn">
                                                    <button class="btn btn-primary" title="Sinh mã vạch tự động"
                                                        ng-click="genBarCode(); $event.preventDefault(); $event.stopPropagation();"><i
                                                            class="fa-regular fa-barcode-read"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Email</label>
                                        <div class="col-sm-8">
                                            <input formControlName="email" class="form-control mb-0 text-left"
                                                type="text" />
                                            <span class="text-danger field-validation-error"
                                                *ngIf="formData.get('email')?.errors?.['email'] && formData.get('email')?.touched">
                                                Email không đúng định dạng!
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Nghề nghiệp</label>
                                        <div class="col-sm-8">
                                            <input formControlName="job" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Khả năng chi trả</label>
                                        <div class="col-sm-8">
                                            <input formControlName="abilityToPay" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p>Thêm <span style="cursor: pointer" (click)="expandForm()">{{expandLabel}}</span></p>
                    <div class="row" *ngIf="showMoreForm">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Tên người liên hệ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="nameContacter" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">SĐT người liên hệ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="phoneContacter" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Quan hệ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="refCus" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="!isMinimized">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã khách</label>
                                        <div class="col-sm-8">
                                            <input formControlName="code" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Tên khách<span
                                                class="text-danger">*</span></label>
                                        <div class="col-sm-8">
                                            <input formControlName="tenKhachHang" class="form-control mb-0 text-left"
                                                type="text" />
                                            <span class="text-danger field-validation-error"
                                                *ngIf="formData.get('tenKhachHang')?.invalid && formData.get('tenKhachHang')?.touched">
                                                Chưa nhập tên khách hàng!
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Giới tính</label>
                                        <div class="col-sm-8">
                                            <select class="form-control mb-0 ng-pristine ng-untouched ng-valid"
                                                formControlName="sexId">
                                                <option value="">--Chọn giới tính--</option>
                                                <option value="0">Nam</option>
                                                <option value="1">Nữ</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Địa chỉ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="diaChi" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Số điện thoại</label>
                                        <div class="col-sm-8">
                                            <input formControlName="soDienThoai" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Nợ đầu kỳ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="noDauky" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã vạch</label>
                                        <div class="col-sm-8">
                                            <div class="input-group">
                                                <input class="form-control mb-0" style="text-align:left" type="text"
                                                    formControlName="barcode" />
                                                <div class="input-group-btn">
                                                    <button class="btn btn-primary" title="Sinh mã vạch tự động"
                                                        ng-click="genBarCode(); $event.preventDefault(); $event.stopPropagation();"><i
                                                            class="fa-regular fa-barcode-read"></i></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Tên nhóm <span
                                                class="text-danger">*</span></label>
                                        <div class="col-sm-8">
                                            <select formControlName="maNhomKhachHang"
                                                class="form-control mb-0 ng-pristine ng-valid ng-touched">
                                                <option *ngFor="let item of listNhomKhachHang;" value="{{item.id}}">
                                                    {{item.tenNhomKhachHang}}</option>
                                            </select>
                                            <span class="text-danger field-validation-error"
                                                *ngIf="formData.get('maNhomKhachHang')?.invalid && formData.get('maNhomKhachHang')?.touched">
                                                Chưa chọn nhóm khách hàng!
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p>Thêm <span style="cursor: pointer" (click)="expandForm()">{{expandLabel}}</span></p>
                    <div class="row" *ngIf="showMoreForm">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Ngày sinh</label>
                                        <div class="col-sm-8">
                                            <input formControlName="birthDate" class="form-control mb-0 text-left"
                                                type="date" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Email</label>
                                        <div class="col-sm-8">
                                            <input formControlName="email" class="form-control mb-0 text-left"
                                                type="text" />
                                            <span class="text-danger field-validation-error"
                                                *ngIf="formData.get('email')?.errors?.['email'] && formData.get('email')?.touched">
                                                Email không đúng định dạng!
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Đơn vị công tác</label>
                                        <div class="col-sm-8">
                                            <input formControlName="donViCongTac" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Kiểu khách hàng</label>
                                        <div class="col-sm-8">
                                            <select class="form-control mb-0 ng-pristine ng-valid ng-touched"
                                                formControlName="cusType">
                                                <option value=""></option>
                                                <option value="false">Cá nhân</option>
                                                <option value="true">Tổ chức</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã số thuế</label>
                                        <div class="col-sm-8">
                                            <input formControlName="taxCode" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Tên người liên hệ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="nameContacter" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">SĐT người liên hệ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="phoneContacter" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mối quan hệ</label>
                                        <div class="col-sm-8">
                                            <input formControlName="refCus" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Ghi chú</label>
                                        <div class="col-sm-8">
                                            <input formControlName="refCus" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã LT QG</label>
                                        <div class="col-sm-8">
                                            <input formControlName="nationalFacilityCode"
                                                class="form-control mb-0 text-left" type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã định danh y tế</label>
                                        <div class="col-sm-8">
                                            <input formControlName="medicalIdentifier"
                                                class="form-control mb-0 text-left" type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Căn cước công dân</label>
                                        <div class="col-sm-8">
                                            <input formControlName="citizenIdentification"
                                                class="form-control mb-0 text-left" type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Mã số bảo hiểm y tế</label>
                                        <div class="col-sm-8">
                                            <input formControlName="healthInsuranceNumber"
                                                class="form-control mb-0 text-left" type="text" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Nghề nghiệp</label>
                                        <div class="col-sm-8">
                                            <input formControlName="job" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-6 form-group">
                                    <div class="row">
                                        <label class="col-sm-4 control-label">Khả năng chi trả</label>
                                        <div class="col-sm-8">
                                            <input formControlName="abilityToPay" class="form-control mb-0 text-left"
                                                type="text" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" (click)="closeModal()">Đóng</button>
            <button type="button" class="btn btn-primary" (click)="saveEdit()">{{customerID > 0 ? 'Cập nhật' : 'Thêm
                mới'}}</button>
        </div>
    </div>
</div>