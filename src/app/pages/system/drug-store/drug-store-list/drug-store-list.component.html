<div>
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar-bg">
        <fieldset class="mb-3">
          <label>Loại NT</label>
          <select class="form-control mb-0">
            <option *ngFor="let i of drugStoreTypes" value="{{i.value}}">{{ i.name }}</option>
          </select>
        </fieldset>
        <fieldset>
          <label>Tìm theo</label>
          <div item-search-filter
               select-changed-callback="onDrugStoreSelectChanged"
               default-selected-changed-callback="onDefaultSelectedChanged"
               enter-key-callback="onSearchAcceptEnterKey"
               clear-after-selected="false"
               forward-enter-key="true"
               only-single-item="false"
               default-selected-item="selectedDrugStoreItem"
               search-type="6"
               search-info-type-Id="0"
               func-calls="searchItemFuncCalls"
               update-search-text-by-selected-result="true"
               search-placeholder="'Tra cứu theo tên, địa chỉ,...'"
               resettable="true"
               resettable-callback="onResetSearching"
               enable-scan-barcode="true"
               class="mb-3">
          </div>
          <label>Số ngày không giao dịch</label>
          <div class="mb-3">
            <input type="text" class="form-control mb-0" awnum="app-decimal-number"
                   ng-model="filterModel.NumDaysNoTrans"/>
          </div>
          <div class="mb-3">
            <div class="control-group">
              <div class="d-flex gap-10">
                <div class="form-check">
                  <input type="checkbox" ng-model="filterModel.IsActivated" class="form-check-input form-control"
                         ng-change="onActivatedSelectChanged()">
                  <label class="form-check-label">NT đã kích hoạt</label>
                </div>
              </div>
            </div>
          </div>
          <div class="mb-3">
            <label>Trạng thái triển khai</label>
            <select ng-change="onDrugStoreDeployTypeChanged(storeDeployTypeId)" class="form-control mb-0">
              <select class="form-control mb-0">
                <option *ngFor="let i of drugStoreDeployTypes" value="{{i.value}}">{{ i.name }}</option>
              </select>
            </select>
          </div>
        </fieldset>
        <fieldset>
          <div class="mb-3">
            <label>Người tạo</label>
            <div report-group-type-filter group-filter-title=""
                 group-filter-type="2"
                 show-group-filter-type="false"
                 single-mode="true"
                 filter-item-type="13"
                 selected-item-id="filterModel.UserId"
                 selected-item="selectedUserItem"
                 item-changed-callback="onUserItemChanged"
                 filter-by-name-for-drug="false"
                 raise-event-on-first-selected-by-default="true"
                 additional-item-name="'--Tất cả--'"
                 disabled-mode="false"
                 class="mb-0"></div>
          </div>
          <div class="mb-3">
            <label>Tỉnh thành</label>
            <div report-group-type-filter group-filter-title=""
                 group-filter-type="2"
                 show-group-filter-type="false"
                 single-mode="true"
                 filter-item-type="14"
                 selected-item-id="filterModel.ProvinceId"
                 selected-item="selectedProvinceItem"
                 item-changed-callback="onProvinceItemChanged"
                 filter-by-name-for-drug="false"
                 raise-event-on-first-selected-by-default="true"
                 additional-item-name="'--Tất cả--'"
                 disabled-mode="false"
                 class="mb-0"></div>
          </div>
          <div class="mb-3">
            <label>Lựa chọn kiểu ngày lọc</label>
            <div class="selectBox" onclick="showCheckboxesFilter()">
              <select class="form-control mb-0">
                <option *ngFor="let i of typeDateItem" value="{{i.value}}">{{ i.name }}</option>
              </select>
              <div class="overSelect"></div>
            </div>
            <div id="checkboxesfilter" ng-model="filterModel.TypeDate">
              <label *ngFor="let i of typeDateItem" for="{{i.name}}">
                <input type="checkbox" ng-change="onSelectedTypeDate(i)"/>{{ i.name }}
              </label>
            </div>
          </div>
          <div class="mb-3">
            <label>Trạng thái phiếu LT</label>
            <select class="form-control mb-0" ng-model="filterModel.ConnectivityFilterTypeId">
              <option *ngFor="let i of connectivityTypes" value="{{i.value}}">{{ i.name }}</option>
            </select>
          </div>
          <div class="mb-3">
            <label>Lựa chọn chính sách bán hàng</label>
            <select class="form-control mb-0" ng-model="filterModel.TypeBasic">
              <option *ngFor="let i of typeDateItem" value="{{i.value}}">{{ i.name }}</option>
            </select>
          </div>
          <div class="mb-3">
            <label>Trạng thái thanh toán</label>
            <select class="form-control mb-0" ng-model="filterModel.TypeBasic">
              <option *ngFor="let i of drugStorePaymentTypes" value="{{i.value}}">{{ i.name }}</option>
            </select>
          </div>
          <div class="mb-3">
            <label>Ngày hết hạn</label>
            <select class="form-control mb-0" ng-model="filterModel.TypeBasic">
              <option *ngFor="let i of expiredTypes" value="{{i.value}}">{{ i.name }}</option>
            </select>
          </div>
          <div class="mb-3 form-check">
            <input type="checkbox" ng-model="filterModel.IsOutOfInvoice" class="form-control form-check-input"
                   ng-change="onOutOfInvoiceSelectChanged()">
            <label class="form-check-label">Đã hết số lượng chứng từ</label>
          </div>
          <div class="mb-3 form-check">
            <label>Trạng thái gửi ZNS</label>
            <select class="form-control mb-0" ng-model="filterModel.TypeBasic">
              <option *ngFor="let i of znsTypes" value="{{i.value}}">{{ i.name }}</option>
            </select>

          </div>
          <div class="mb-3">
            <label>Chăm sóc sau bán hàng</label>
            <select ng-change="onSupporterFilterChanged(supporterId)" class="form-control mb-0" ng-model="supporterId">
              <option value="-1" selected>--Tất cả--</option>
              <!-- <option ng-repeat="i in supperUsers" value="{{i.StaffId}}">
                  {{i.StaffName}}
              </option> -->
            </select>
          </div>
        </fieldset>
        <fieldset class="baocao-filter">
          <div report-date-rage-filter
               display-data-table-id="table-id-drug-stores"
               filter-type="filterType"
               display-data-callback="onDisplayData"
               supress-export="!permittedFields.Export_Stores" supress-print="true"
               call-callback-after-init="true"
               export-callback="onExport"></div>
          <a href="/Nhathuoc/Create" class="btn btn-primary mt-3 w-100">
            Thêm mới
          </a>
        </fieldset>
      </div>
    </div>

    <div class="col-md-9" style="font-size:small">
      <div class="box-group-white">
        <div style="padding: 20px 0">
          <div id="customCheckboxs" class="mb-3">
            <div class="selectBox" onclick="showCheckboxes()">
              <select class="form-control mb-0">
                <option selected="selected" disabled="disabled" value="">Ẩn/Hiện thông tin</option>
              </select>
              <div class="overSelect"></div>
            </div>
            <div id="checkboxes">
              <label *ngFor="let i of hideColumns">
                <input type="checkbox" ng-change="onSelectedHideColum(i.id)" ng-model="i.disable"/>
              </label>
            </div>
          </div>
          <h2 class="text-center"><b>DANH SÁCH NHÀ THUỐC</b></h2>

        </div>
        <div class="baocao-container" (scroll)="onTableScroll()">
          <table class="table table-striped table-bordered table-hover tr-ng-grid">
            <thead>
            <tr class="sticky-row">
              <th class="text-right">
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> #</div>
                </div>
              </th>
              <th #titleCode class="sticky-col">
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Mã</div>
                </div>
              </th>
              <th #titleName class="sticky-col">
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Tên</div>
                </div>
              </th>
              <th #titleAddress class="sticky-col">
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Địa chỉ</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Tỉnh thành</div>
                </div>
              </th>
              <th #titlePhone class="sticky-col">
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Điện thoại</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Người đại diện</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Người tạo</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Ngày tạo - Ngày hết hạn</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> TT gửi tin XN tạo TK</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Mã QG</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> TK LT</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> C.S bán hàng</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Nhân viên kinh doanh</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Chăm sóc sau bán hàng</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Ghi chú kinh doanh</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Ghi chú triển khai</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Kết quả triển khai</div>
                </div>
              </th>
              <!-- Quyền update tiền đã thanh toán được TechnicalSupport cấp-->
              <th *ngIf="true">
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Tiền thanh toán</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Tổng tiền</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> TT thu tiền</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> TT gửi tin XNTT</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> KQ gửi tin XNTT</div>
                </div>
              </th>
              <th>
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Ngày thu tiền</div>
                </div>
              </th>
              <!--Lựa chọn kiểu ngày lọc là "Ngày giao dịch"-->
              <th *ngIf="true">
                <div class="tr-ng-column-header tr-ng-cell">
                  <div class="tr-ng-title"> Tổng (nhập/ xuất)</div>
                </div>
              </th>
              <th></th>
            </tr>

            </thead>
            <tbody>
            <tr *ngFor="let data of dataTable; index as i;">
              <!--STT-->
              <td>
                <div>
                  <a href="" data-toggle="modal" data-target="#regional-details-dialog">
                    {{ (page - 1) * pageSize + i + 1 }}
                  </a>
                </div>
              </td>

              <!--Mã nhà thuốc-->
              <td class="sticky-col" [ngStyle]="{'background-color': '#fff', 'left.px': contentCodeLeft}">
                <div class="text-left">
                  <a href="" (click)="drugStoreCode = '0010'" data-toggle="modal"
                     data-target="#general-store-mapping-dialog">
                    {{ data.maNhaThuoc }}
                  </a>
                </div>
              </td>

              <!--Tên nhà thuốc-->
              <td class="sticky-col" title="quản lý" [ngStyle]="{'background-color': '#fff', 'left.px': contentNameLeft}">
                <div class="text-left">
                  <span class="label label-info pull-right">
                      <!-- {{gridItem.StoreHat}} -->QL
                  </span>
                  <br/>
                  <a href="/">
                    {{ data.tenNhaThuoc }}
                  </a>
                </div>
              </td>

              <!--Địa chỉ-->
              <td class="sticky-col" [ngStyle]="{'background-color': '#fff', 'left.px': contentAddressLeft}">
                <div class="text-left">
                  {{ data.diaChi }}
                </div>
              </td>

              <!--Tỉnh thành-->
              <td>
                <div class="text-left">
                  <!--{{ data.province }}-->
                  Hà Nội
                </div>
              </td>

              <!--Điện thoại-->
              <td class="sticky-col" [ngStyle]="{'background-color': '#fff', 'left.px': contentPhoneLeft}">
                <div class="text-left" [innerHTML]="getPhoneNumbers(data)"></div>
              </td>

              <!--Người đại diện-->
              <td>
                <div class="text-left">
                  {{ data.nguoiDaiDien }}
                </div>
              </td>

              <!--Người tạo-->
              <td>
                <div class="text-left">
                <!--{{ data.userName }}-->Trần Kiều Trang
                </div>
              </td>

              <!--Ngày tạo - Ngày hết hạn-->
              <td field-name="CreatedDate">
                <div class="text-left">
                   {{data.created | appDate}}
                   <br>
                   {{data.expiredDate ? (data.expiredDate | appDate) : ''}}
                </div>
              </td>
              <!--TT gửi tin tạo tài khoản--> <!--Check quyền cập nhật trang thái thanh toán-->
              <td [ngClass]="{'row-item-connectivity': data.znsstatusSendCreateAccount && !false}">
                <div class="text-left">
                   {{data.znsstatusSendCreateAccount ? 'Đã gửi' : 'Chưa gửi'}}
                </div>
              </td>
              <!--Mã QG-->
              <td [ngClass]="data.isConnectivity ? (data.isNationalDBConnected ? 'row-item-connectivity' : 'row-item-connectivity-not-connected') : '' ">
                <div class="text-left">
                  <span>{{data.connectivityCode}}</span>
                  <button *ngIf="data.isConnectivity"
                          class="btn btn-primary btn-sm"
                          (click)="onCheckConnectivity(data)">
                    <i class="fa-regular fa-arrows-rotate"></i>
                  </button>
                </div>
              </td>

              <!--TK LT-->
              <td>
                <div class="text-left">
                  {{data.connectivityUserName}}
                  <br>
                  {{data.connectivityPassword}}
                </div>
              </td>

              <!--Chính sách bán hàng-->
              <td>
                <div class="text-left">
                  <!--{{data.nameTypeBasis}}-->
                </div>
              </td>
              <!--Nhân viên kinh doanh-->
              <td>
                <!-- <select class="form-control" ng-model="gridItem.BusinessId" ng-change="onBusinessChanged(gridItem)">
                    <option value="0">Chọn nhân viên kinh doanh</option>
                    <option ng-repeat="i in supperUsers" value="{{i.StaffId}}">{{i.StaffName}}</option>
                </select> -->
              </td>
              <!--Chăm sóc sau bán hàng-->
              <td>
                <!-- <select class="form-control" ng-model="gridItem.SupporterId" ng-change="onSupporterChanged(gridItem)">
                    <option value="0">Chọn nhân viên</option>
                    <option ng-repeat="i in supperUsers" value="{{i.StaffId}}">{{i.StaffName}}</option>
                </select> -->
              </td>
              <!--Ghi chú bán hàng-->
              <td>
                <div ng-if="!gridItem.IsEditNoteType">
                  <!-- {{gridItem.NoteType}} -->Bán hàng 1
                  <a class="btn btn-sm btn-primary" title="Cập nhật thông tin"
                     ng-click="onOpenEditNoteType(gridItem)"><i class="fa-regular fa-pen"></i></a>
                </div>
                <div ng-if="gridItem.IsEditNoteType" style="width: 150px">
                                        <textarea type="text" ng-init="gridItem.InputNoteType = gridItem.NoteType"
                                                  ng-model="gridItem.InputNoteType" class="form-control mb-2"
                                                  data-inputmask="'alias': 'numeric', 'groupSeparator': ',', 'autoGroup': true, 'digits': 0, 'digitsOptional': false, 'suffix': '', 'placeholder': '0'">
                                        </textarea>
                  <input type="button" value="Lưu" class="btn btn-sm btn-primary w-100"
                         ng-click="onUpdateNoteType(gridItem); $event.preventDefault(); $event.stopPropagation();">
                </div>
              </td>
              <!--Ghi chú triển khai-->
              <td>
                <div ng-if="!gridItem.IsEditBusinessDescription">
                  <!-- {{gridItem.BusinessDescription}} -->Kinh doanh 1
                  <a class="btn btn-sm btn-primary" title="Cập nhật thông tin"
                     ng-click="onOpenEditBusinessDescription(gridItem)"><i class="fa-regular fa-pen"></i></a>
                </div>
                <div style="width: 150px" ng-if="gridItem.IsEditBusinessDescription">
                                        <textarea type="text"
                                                  ng-init="gridItem.InputBusinessDescription = gridItem.BusinessDescription"
                                                  ng-model="gridItem.InputBusinessDescription" class="form-control mb-2"
                                                  data-inputmask="'alias': 'numeric', 'groupSeparator': ',', 'autoGroup': true, 'digits': 0, 'digitsOptional': false, 'suffix': '', 'placeholder': '0'">
                                        </textarea>
                  <input type="button" value="Lưu" class="btn btn-sm btn-primary w-100"
                         ng-click="onUpdateBusinessDescription(gridItem); $event.preventDefault(); $event.stopPropagation();">
                </div>
              </td>

              <!--Kết quả triển khai-->
              <td>
                <div style="width: 150px" class="text-left">
                  <!-- <select ng-change="onResultBusinessChanged(gridItem)" class="form-control mb-0" ng-model="gridItem.ResultBusinessId">
                      <option ng-repeat="i in lstResultBusiness" value="{{i.Id}}">
                          {{i.Name}}
                      </option>
                  </select> -->
                </div>
              </td>


              <!--Tiền thanh toán-->
              <td>
                <div style="width: 150px" class="form-inline">
                  <div style="text-align: right">
                    <input
                      ng-init="gridItem.InputPaidDate = gridItem.PaidDate != null ? (gridItem.PaidDate | appDate) : ''"
                      style="display:none; width: 42px" type="text" ng-model="gridItem.InputPaidDate"/>
                  </div>
                  <div class="input-group mb-2">
                    <input type="text" ng-init="gridItem.InputPaidMoney = (gridItem.PaidMoney | number : 0)"
                           ng-model="gridItem.InputPaidMoney" class="form-control" oninput="paidMoneyInputmask(this);"
                           data-inputmask="'alias': 'numeric', 'groupSeparator': ',', 'autoGroup': true, 'digits': 0, 'digitsOptional': false, 'suffix': '', 'placeholder': '0'"/>
                    <span class="input-group-btn">
                                                <button class="btn btn-primary"
                                                        ng-click="onDateCheckClick(gridItem); $event.preventDefault(); $event.stopPropagation();"><i
                                                  class="fa-regular fa-calendar-days"></i></button>

                                            </span>
                  </div>
                  <input type="button" value="Lưu" class="btn btn-sm btn-primary w-100" (click)="drugStoreCode='0010'"
                         data-toggle="modal" data-target="#confirm-payment-send-zns-dialog">
                </div>
              </td>
              <!--Tổng tiền-->
              <td>
                <div class="text-right">
                  {{data.paidAmount | number}}
                </div>
              </td>
              <!--Trạng thái thanh toán-->
              <td>
                <div class="text-left">
                  <input type="checkbox" class=" form-check-input" ng-checked="gridItem.PaidMoney > 0"
                         onclick="this.checked = !this.checked;" title=""/>
                </div>
              </td>
              <!--Trạng thái gửi tin TT-->
              <td [ngClass]="{'row-item-connectivity': data.znsstatusSendPayment && !false}">
                <div class="text-left">
                  {{data.znsstatusSendPayment ? 'Đã gửi' : 'Chưa gửi'}}
                </div>
              </td>
              <!--Kết quả gửi tin-->
              <td>
                <div>
<!--                   {{data.znsstatusSendPayment ?  : ''}}-->
                  Gửi thành công
                </div>
              </td>
              <!--Ngày thanh toán-->
              <td>
                <div class="text-left">
                  {{data.paidDate ? (data.paidDate | appDate) : ''}}
                </div>
              </td>
              <!--Tổng pn/px-->
              <td>
                <div>
                  <!-- {{gridItem.TotalReceiptNote | number:0}}<br /> {{gridItem.TotalDeliveryNote | number:0}} -->
                  10<br/>15
                </div>
              </td>
              <!--Actions-->
              <td>
                <div ng-if="gridItem.IsActivated" class="baocao-actions baocao-actions-row">
                  <div class="baocao-actions-item">
                    <a href="/" class="btn btn-sm btn-primary">
                      <i class="fa-regular fa-pen-to-square"></i>
                    </a>
                    <a href="#" class="btn btn-sm btn-danger"
                       ng-click="onDelete(gridItem); $event.preventDefault(); $event.stopPropagation();">
                      <i class="fa-regular fa-trash"></i>
                    </a>
                  </div>
                  <div class="baocao-actions-item">
                    <a href="" class="btn btn-sm btn-primary" (click)="drugStoreCode='0010'"
                       data-toggle="modal" data-target="#criteria-business-dialog">
                      Triển khai
                    </a>
                  </div>
                </div>
                <div ng-if="!gridItem.IsActivated">
                  <a href="#" class="btn btn-sm btn-primary"
                     ng-click="onRestore(gridItem); $event.preventDefault(); $event.stopPropagation();">
                    Khôi phục
                  </a>
                </div>
              </td>
            </tr>
            </tbody>
            <tfoot>
            <tr id="footerId">
              <td colspan="100">
                <app-pagination [currentPage]="page" [totalPages]="totalPages" [totalRecord]="totalRecord"
                                (pageChange)="changePageIndex($event)"
                                (pageSizeChange)="changePageSize($event)"></app-pagination>
              </td>
            </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
