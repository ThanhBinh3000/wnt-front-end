<div class="row">
    <div class="col-md-3">
        <div class="sidebar-bg">
            <h2 class="title-section title-border">PHIẾU KIỂM KÊ CHI TIẾT</h2>
            <table class="table table-bordered">
                <tr>
                    <td>
                        <label class="mb-0">Mã phiếu: </label>
                    </td>
                    <td>
                        <!-- {{InventoryModel.Id}} -->1
                    </td>
                </tr>

                <tr>
                    <td>
                        <label class="mb-0">Người lập: </label>
                    </td>
                    <td>
                        <!-- {{InventoryModel.FullName}} -->Nhân viên A
                    </td>
                </tr>

                <tr>
                    <td>
                        <label class="mb-0">Ngày tạo: </label>
                    </td>
                    <td>
                        <!-- {{InventoryModel.CreateTime | date:'dd/MM/yyyy'}} -->1/1/2024
                    </td>
                </tr>

                <tr>
                    <td>
                        <label class="mb-0">Cân kho: </label>
                    </td>
                    <td ng-if="InventoryModel.DaCanKho" style="text-align : left">
                        <i class="fa-regular fa-check text-success"></i>
                    </td>
                    <td ng-if="!InventoryModel.DaCanKho" style="text-align : left">
                        <i class="fa-regular fa-xmark text-danger"></i>
                    </td>
                </tr>
            </table>
            <div ng-show="canAction" class="d-flex justify-content-end align-items-center gap-10 flex-wrap mt-3">
                <a class="btn btn-default flex-grow-1" href="/Inventory/Index">Quay lại</a>
                <a class="btn btn-default flex-grow-1" href="/Inventory/In/" target="_blank">In</a>
                <div ng-if="!InventoryModel.DaCanKho">
                    <a class="btn btn-primary flex-grow-1" (click)="noteId=1" href="management/inventory/inventory-add-edit">Sửa/Cân kho</a>
                </div>
                <a class="btn flex-grow-1 btn-danger" href="/Inventory/Delete/">Xóa</a>
                <button class="btn btn-primary flex-grow-1" ng-show="InventoryModel.NhaThuoc_MaNhaThuoc == '7892'" ng-click="onExportExcel()">Xuất Excel</button>
            </div>
            <div ng-show="!canAction" class="d-flex justify-content-end align-items-center gap-10 flex-wrap mt-3">
                <a class="btn btn-default flex-grow-1" href="/NoteManagement/NotesListing##noteTypeId=5">Quay lại</a>
            </div>
        </div>
    </div>
    <div class="col-md-9">
        <div class="box-group-white baocao-container">
            <h2 class="text-center"><b>Danh sách thuốc</b></h2>
            <table class="table table-striped table-bordered table-hover tr-ng-grid">
                <thead>
                    <tr>
                        <th style="width: 6%" class="header-bg" display-name="STT">STT</th>
                        <th field-name="TenNhomThuoc" style="width: 15%" class="header-bg" display-name="Nhóm Thuốc" enable-sorting="true">Nhóm thuốc</th>
                        <th field-name="MaThuoc" style="width: 12%" class="header-bg" display-name="Mã Thuốc" enable-sorting="true">Mã thuốc</th>
                        <th field-name="TenThuoc" style="width: 20%" class="header-bg" display-name="Tên Thuốc" enable-sorting="true">Tên thuốc</th>
                        <th field-name="DonVi" style="width: 8%" class="header-bg" display-name="Đơn vị">Đơn vị</th>
                        <th field-name="TonKho" style="width: 10%" class="header-bg" display-name="SL hệ thống" enable-sorting="true">SL hệ thống</th>
                        <th field-name="ThucTe" style="width: 5%" class="header-bg" display-name="SL thực" enable-sorting="true">SL thực</th>
                        <th field-name="Chenhlech" style="width: 5%" class="header-bg" display-name="SL chênh lệch" enable-sorting="false">
                            <span>SL chênh lệch</span>
                        </th>
                        <th field-name="GiaKiemKe" style="width: 14%" class="header-bg" display-name="Giá kiểm kê" enable-sorting="true">Giá kiểm kê</th>
                        <th style="width: 5%" class="header-bg" display-name="Giá/Lô/Hạn dùng">
                            <span>Giá/Lô/Hạn dùng</span>
                        </th>
                        <th ng-show="canAction" style="width: 5%" class="header-bg"></th>
                    </tr>
                </thead>
                <tbody id="table-body-id-delivery-note-with-barcode">
                    <tr class="tr-barcode">
                        <!--STT-->
                        <td>
                            <div>
                                <!-- {{gridOptions.currentPage * model.pageSize + $index + 1}} -->1
                            </div>
                        </td>
                        <!--Tên nhóm thuốc-->
                        <td field-name="TenNhomThuoc">
                            <div>
                                <!-- {{gridItem.TenNhomThuoc}} -->Nhóm 1
                            </div>
                        </td>

                        <!--Mã Thuốc-->
                        <td field-name="MaThuoc">
                            <div>
                                <!-- {{gridItem.MaThuoc}} -->TH01
                            </div>
                        </td>

                        <!--Tên thuốc-->
                        <td field-name="TenThuoc">
                            <div>
                                <!-- {{gridItem.TenThuoc}} -->Thuốc 1
                            </div>
                        </td>
                        <!--Đơn vị-->
                        <td field-name="DonVi">
                            <div>
                                <!-- {{gridItem.TenDonViTinh}} --> hộp
                            </div>
                        </td>
                        <!--Số Lượng hệ thống-->
                        <td field-name="TonKho">
                            <div style="text-align:right">
                                <!-- {{gridItem.TonKho}} -->1
                            </div>
                        </td>
                        <!--Số Lượng thực tế-->
                        <td field-name="ThucTe">
                            <div style="text-align:right">
                                <!-- {{gridItem.ThucTe | DrugQuantityFilter:1}} -->1
                            </div>
                        </td>
                        <!--Chênh lệch-->
                        <td field-name="Chenhlech">
                            <div style="text-align:right">
                                <!-- {{gridItem.ThucTe - gridItem.TonKho | DrugQuantityFilter:1}} -->1
                            </div>
                        </td>
                        <!--Giá kiểm kê-->
                        <td field-name="GiaKiemKe">
                            <div style="text-align:right" ng-if="permittedFields.Drug_ViewInputPrice">
                                <!-- {{gridItem.Gia | number: 0}} -->1.000
                            </div>
                            <div ng-if="!permittedFields.Drug_ViewInputPrice">***</div>
                        </td>
                        <!-- Ô cập nhật giá/lô/hạn dùng-->
                        <td>
                            <div ng-show="canAction" style="text-align:center">
                                <a href="#" id="" class="btn btn-sm btn-primary" 
                                (click)="drugId=1" data-toggle="modal" data-target="#inventory-item-update-dialog"  title="Cập nhật giá/lô/hạn dùng"><i class="fa-regular fa-calendar-days"></i></a>
                            </div>
                            <div ng-show="!canAction" style="text-align:center">
                                <!-- {{gridItem.SoLo}} - {{gridItem.HanDung | appDate}} --> 123 - 1/1/2025
                            </div>
                        </td>

                        <!-- Xóa thuốc đã cân kho (chỉ cho admin NT thực hiện)-->
                        <td ng-show="canAction">
                            <div style="text-align:center" ng-show="isSuperUser || isAdminUser">
                                <a class="delete-drug btn btn-danger btn-sm" style="cursor: pointer" title="Xóa" ng-click="onRemoveDrug(gridItem); $event.preventDefault(); $event.stopPropagation();"><i class="fa-regular fa-trash"></i></a>
                            </div>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr id="footerId">
                        <td align="center"
                            class="ng-scope" colspan="11">
                            <div class="tr-ng-grid-footer form-inline">
                                <div ng-switch-when="true" class="ng-scope">
                                    <div ng-transclude=""><span class="form-group pull-left page-size ng-scope">
                                            <select id="ddlPageSize"
                                                class="form-control ng-pristine ng-untouched ng-valid"
                                                ng-model="model.pageSize"
                                                ng-options="item.pageSizeKey as item.pageSizeValue for item in pageSizeList"
                                                ng-change="changePageSize()">
                                                <option label="10" value="number:10" selected="selected">10</option>
                                                <option label="20" value="number:20">20</option>
                                                <option label="50" value="number:50">50</option>
                                                <option label="100" value="number:100">100</option>
                                                <option label="--All--" value="number:9000">--All--</option>
                                            </select>
                                            <span class="page-size-label">&nbsp;&nbsp;Dòng / Trang</span>
                                        </span><span class="pull-right form-group" tr-ng-grid-pager=""
                                            style="height:40px;">
                                            <ul class="pagination">
                                                <li class="ng-scope active">
                                                    <a href="" ng-click="navigateToPage(pageIndex)"
                                                        ng-if="pageIndex!==null"
                                                        class="ng-binding ng-scope" title="Trang">1</a>
                                                    </li>
                                                    <li ng-if="pageSelectionActive" class="ng-scope"><a href=""
                                                            class="ng-binding ng-scope" title="Trang">2</a> </li>
                                                    <li class="disabled" style="white-space: nowrap;"> <span
                                                            ng-hide="totalItemsCount || !displayTotalItemsCount"
                                                            class="ng-binding ng-hide">Không có dữ liệu</span> <span
                                                            ng-show="totalItemsCount &amp;&amp; displayTotalItemsCount"
                                                            class=""> <span class="ng-binding">Tổng: 2 bản ghi</span>
                                                        </span> </li>
                                                </ul>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tfoot>
            </table>
        </div>

        <br />

        <div ng-if="InventoryModel.DaCanKho">
            <fieldset>
                <label>Phiếu nhập/xuất sau cân kho</label>
                <div>
                    <table class="table table-responsive table-bordered" id="tbl">
                        <thead>
                            <tr>
                                <th style="background-color:darkgray">#</th>
                                <th style="background-color:darkgray">Số phiếu</th>
                                <th style="background-color:darkgray">Loại phiếu</th>
                                <th style="text-align: right; background-color:darkgray">
                                    Số lượng mặt hàng
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="phieuCanKhoItem in InventoryModel.PhieuCanKhoChiTiet">
                                <td>
                                    <!-- {{$index + 1}} -->1
                                </td>
                                <td>
                                    <div ng-if="phieuCanKhoItem.SoLuong <= 0 ">
                                        <label>N/A</label>
                                    </div>

                                    <div ng-if="phieuCanKhoItem.LoaiPhieu == 1 && phieuCanKhoItem.SoLuong > 0 ">
                                        <a href="/PhieuNhaps/Details/" target="_blank">
                                            <!-- {{phieuCanKhoItem.SoPhieu}} -->1
                                        </a>
                                    </div>

                                    <div ng-if="phieuCanKhoItem.LoaiPhieu == 2 && phieuCanKhoItem.SoLuong > 0 ">
                                        <a href="/PhieuXuats/Details/" target="_blank">
                                            <!-- {{phieuCanKhoItem.SoPhieu}} -->1
                                        </a>
                                    </div>
                                </td>
                                <td>
                                    <span ng-if="phieuCanKhoItem.LoaiPhieu == 1">Phiếu Nhập</span>
                                    <span ng-if="phieuCanKhoItem.LoaiPhieu == 2">Phiếu Xuất</span>
                                </td>
                                <td style="text-align: right"><span class="chenhlech">
                                    <!-- {{phieuCanKhoItem.SoLuong}} -->1
                                </span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </fieldset>
        </div>
    </div>
</div>
<inventory-item-update-dialog [drugId]="drugId"></inventory-item-update-dialog>
