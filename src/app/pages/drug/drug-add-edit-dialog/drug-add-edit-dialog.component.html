<div class="card">
  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" (click)="closeModal()" aria-label="Đóng"><span>&times;</span></button>
      <h4 class="modal-title">{{drugId > 0 ? 'Cập nhật thuốc' : 'Thêm mới thuốc'}}
      </h4>
    </div>
    <div class="modal-body">
      <ul class="nav nav-tabs mb-3">
        <li [ngClass]="{'active' : checkTab == 'main-information'}">
          <a href="javascript:void(0);"
            [ngClass]="checkTab == 'main-information' ? 'tab-check-color' : 'tab-uncheck-color'"
            (click)="checkTab = 'main-information'">Thông tin chính</a>
        </li>
        <li [ngClass]="{'active' : checkTab == 'additional-information'}">
          <a href="javascript:void(0);"
            [ngClass]="checkTab == 'additional-information' ? 'tab-check-color' : 'tab-uncheck-color'"
            (click)="checkTab = 'additional-information'">Thông tin bổ sung</a>
        </li>
        <li *ngIf="enableTrainingStaff" [ngClass]="{'active' : checkTab == 'replace-together'}">
          <a href="javascript:void(0);"
            [ngClass]="checkTab == 'replace-together' ? 'tab-check-color' : 'tab-uncheck-color'"
            (click)="checkTab = 'replace-together'">Hàng thay thế - Hàng bán kèm</a>
        </li>
      </ul>
      <div class="row" [hidden]="checkTab != 'main-information'">
        <form [formGroup]="formData">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Vị trí tủ/kho</label>
                  <div class="col-sm-8">
                    <ng-select appendTo="body" formControlName="idWarehouseLocation">
                      <ng-option [value]="0">Hãy chọn vị trí tủ/kho</ng-option>
                      <ng-option *ngFor="let item of listWarehouse" [value]="item.id">{{item.nameWarehouse}}</ng-option>
                    </ng-select>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Nhóm thuốc<span class="text-danger">*</span></label>
                  <div class="col-sm-8">
                    <div class="input-group ip-equal-height">
                      <div class="flex-grow-1">
                        <ng-select appendTo="body" formControlName="nhomThuocMaNhomThuoc">
                          <ng-option [value]="0">Hãy chọn nhóm thuốc</ng-option>
                          <ng-option *ngFor="let item of listNhomThuoc"
                            [value]="item.id">{{item.tenNhomThuoc}}</ng-option>
                        </ng-select>
                        <span
                          *ngIf="formData.get('nhomThuocMaNhomThuoc')?.invalid && formData.get('nhomThuocMaNhomThuoc')?.touched">
                          <span class="text-danger field-validation-error"
                            *ngIf="formData.get('nhomThuocMaNhomThuoc')?.errors?.['required'] || formData.get('nhomThuocMaNhomThuoc')?.errors?.['min']?.['actual'] < 1">
                            Bạn phải chọn nhóm thuốc!
                          </span>
                        </span>
                      </div>
                      <div class="input-group-btn">
                        <button type="button" class="btn btn-primary" (click)="openAddEditNhomThuocDialog()"
                          title="Thêm mới nếu chưa có">
                          <i class="fa-regular fa-plus"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Đơn vị xuất lẻ<span class="text-danger">*</span></label>
                  <div class="col-sm-8">
                    <ng-select (ngModelChange)="onChangeDonVi(0)" appendTo="body" formControlName="donViXuatLeMaDonViTinh">
                      <ng-option [value]="0">Hãy chọn đơn vị xuất lẻ</ng-option>
                      <ng-option *ngFor="let item of listDonViTinh" [value]="item.id">{{item.tenDonViTinh}}</ng-option>
                    </ng-select>
                    <span
                      *ngIf="formData.get('donViXuatLeMaDonViTinh')?.invalid && formData.get('donViXuatLeMaDonViTinh')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('donViXuatLeMaDonViTinh')?.errors?.['required'] || formData.get('donViXuatLeMaDonViTinh')?.errors?.['min']?.['actual'] < 1">
                        Bạn phải chọn đơn vị xuất lẻ!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Mã thuốc<span class="text-danger">*</span></label>
                  <div class="col-sm-8">
                    <input formControlName="maThuoc" class="form-control mb-0 text-left" type="text" />
                    <span *ngIf="formData.get('maThuoc')?.invalid && formData.get('maThuoc')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('maThuoc')?.errors?.['required']">
                        Chưa nhập mã thuốc!
                      </span>
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('maThuoc')?.errors?.['maxlength']">
                        Mã thuốc không được vượt quá 255 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
              <div *ngIf="permittedFields.drug_ViewInPrice" class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Giá nhập lẻ</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="GiaNhap" id="GiaNhap" mask="separator" class="form-control mb-0"
                        tabindex="13" formControlName="giaNhap" placeholder="Giá nhập theo đơn vị xuất lẻ">
                      <span
                        class="input-group-addon flex-grow-width-25 ng-binding">/{{(formData.get('tenDonViTinhXuatLe')?.value)}}</span>
                      <!-- <div class="input-group-btn">
                        <span ng-show="false" class="btn btn-primary ng-hide"
                          ng-click="onUpdatePriceChildStore(0); $event.preventDefault(); $event.stopPropagation();"
                          title="Cập nhật giá nhập cho cơ sở khác">
                          <i class="fa-regular fa-arrows-rotate"></i>
                        </span>
                      </div> -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Tên thuốc<span class="text-danger">*</span></label>
                  <div class="col-sm-8">
                    <input type="text" name="TenThuoc" id="TenThuoc" class="form-control mb-0" tabindex="3"
                      formControlName="tenThuoc" placeholder="Tên biệt dược + Hàm lượng/Hãng" />
                    <span *ngIf="formData.get('tenThuoc')?.invalid && formData.get('tenThuoc')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('tenThuoc')?.errors?.['required']">
                        Chưa nhập tên thuốc!
                      </span>
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('tenThuoc')?.errors?.['maxlength']">
                        Tên thuốc không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                    <p class="btn-link tooltip-content-drug"
                      style="color: seagreen; font-style: italic; padding-left: 10px; cursor: pointer"
                      ng-click="onSearchPriceInOut()" title="Tra cứu giá thị trường">
                      <i class="fa fa-line-chart" style="color: #FD7A42"></i> Check giá nhé!
                    </p>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Giá bán lẻ</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="GiaBanLe" id="GiaBanLe" class="form-control mb-0" tabindex="14"
                        mask="separator" formControlName="giaBanLe" awnum="app-decimal-number"
                        placeholder="Giá bán lẻ theo đơn vị xuất lẻ">
                      <span
                        class="input-group-addon flex-grow-width-25 ng-binding">/{{formData.get('tenDonViTinhXuatLe')?.value}}</span>
                      <!-- <div class="input-group-btn">
                        <span ng-show="false" class="btn btn-primary ng-hide"
                          ng-click="onUpdatePriceChildStore(1); $event.preventDefault(); $event.stopPropagation();"
                          title="Cập nhật giá bán cho cơ sở khác">
                          <i class="fa-regular fa-arrows-rotate"></i>
                        </span>
                      </div> -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Mô tả thêm</label>
                  <div class="col-sm-8">
                    <input type="text" name="ThongTin" id="ThongTin" class="form-control mb-0" tabindex="4"
                      formControlName="thongTin" placeholder="Vị trí tủ, hoạt chất" />
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Đơn vị nhập</label>
                  <div class="col-sm-8">
                    <ng-select (ngModelChange)="onChangeDonVi(1)" appendTo="body" formControlName="donViThuNguyenMaDonViTinh">
                      <ng-option [value]="0">none</ng-option>
                      <ng-option *ngFor="let item of listDonViTinh" [value]="item.id">{{item.tenDonViTinh}}</ng-option>
                    </ng-select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Mã vạch</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input class="form-control mb-0" style="text-align:left" type="text" formControlName="barCode" />
                      <div class="input-group-btn">
                        <button class="btn btn-primary" title="Sinh mã vạch tự động" (click)="genBarcode()">
                          <i class="fa-regular fa-barcode-read"></i>
                        </button>
                      </div>
                    </div>
                    <span *ngIf="formData.get('barCode')?.invalid && formData.get('barCode')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('barCode')?.errors?.['maxlength']">
                        Tên thuốc không được vượt quá 20 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Quy cách</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="HeSo" id="HeSo" mask="separator" class="form-control mb-0 ng-pristine"
                        tabindex="16" formControlName="heSo" awnum="app-decimal-number">
                      <span class="input-group-addon flex-grow-width-25 ng-scope">
                        {{formData.get('donViThuNguyenMaDonViTinh')?.value > 0
                        ? formData.get('tenDonViTinhThuNguyen')?.value + ' ' + formData.get('heSo')?.value + ' ' +
                        formData.get('tenDonViTinhXuatLe')?.value
                        : formData.get('tenDonViTinhXuatLe')?.value}}
                      </span>
                    </div>
                    <span *ngIf="formData.get('heSo')?.invalid && formData.get('heSo')?.valueChanges">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('heSo')?.errors?.['required']">
                        Chưa nhập quy cách!
                      </span>
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('tenThuoc')?.errors?.['min']?.['actual'] < 1">
                        Quy cách không được nhỏ hơn 1
                      </span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-2 form-group">
                <div class="row">
                  <label class="col-sm-8 control-label">Hàng tư vấn</label>
                  <div class="col-sm-4">
                    <input type="checkbox" name="HangTuVan" id="HangTuVan" class="form-checkbox check-box " tabindex="6"
                      formControlName="hangTuVan">
                  </div>
                </div>
              </div>
              <div class="col-md-4 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Loại hàng</label>
                  <div class="col-sm-8">
                    <ng-select appendTo="body" formControlName="productTypeId">
                      <ng-option *ngFor="let item of listProductTypes"
                        [value]="item.id">{{item.displayName}}</ng-option>
                    </ng-select>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Giá bán sỉ</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="GiaBanBuon" id="GiaBanBuon" mask="separator"
                        class="form-control mb-0 ng-pristine" tabindex="17" formControlName="giaBanBuon"
                        awnum="app-decimal-number">
                      <span *ngIf="formData.get('donViThuNguyenMaDonViTinh')?.value > 0"
                        class="input-group-addon flex-grow-width-25 ng-binding ng-scope">/{{formData.get('tenDonViTinhThuNguyen')?.value}}
                      </span>
                      <span *ngIf="formData.get('donViThuNguyenMaDonViTinh')?.value <= 0"
                        class="input-group-addon flex-grow-width-25 ng-binding ng-scope">/{{formData.get('tenDonViTinhXuatLe')?.value}}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Hạn dùng</label>
                  <div class="col-sm-8">
                    <input type="text" name="HanDung" id="HanDung"
                      class="input-datetime form-control mb-0 text-box single-line " tabindex="7"
                      formControlName="hanDung" placeholder="Nhập 010122 => 01/01/2022"
                      (ngModelChange)="onExpiredDateChange()">
                    <span *ngIf="formData.get('hanDung')?.invalid && formData.get('hanDung')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('hanDung')?.errors?.['invalidDate']">
                        Hạn dùng chưa chính xác!
                      </span>
                    </span>
                    <!-- <pre>{{ formData.get('hanDung')?.errors | json }}</pre> -->
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Số tồn ban đầu</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="SoDuDauKy" id="SoDuDauKy" mask="separator" class="form-control mb-0  "
                        tabindex="18" formControlName="soDuDauKy" formControlName="soDuDauKy" awnum="app-decimal-number"
                        placeholder="Số tồn ban đầu theo đơn vị xuất lẻ">
                      <span
                        class="input-group-addon flex-grow-width-25 ng-binding">{{formData.get('tenDonViTinhXuatLe')?.value}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Số lượng cảnh báo</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="GioiHan" id="GioiHan" mask="separator" class="form-control mb-0  "
                        value="0" tabindex="8" formControlName="gioiHan">
                      <span
                        class="input-group-addon flex-grow-width-25 ng-binding">{{formData.get('tenDonViTinhXuatLe')?.value}}</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Giá nhập ban đầu</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="GiaDauKy" id="GiaDauKy" mask="separator" class="form-control mb-0"
                        tabindex="19" formControlName="giaDauKy" awnum="app-decimal-number"
                        placeholder="Giá nhập ban đầu cho số tồn b.đầu">
                      <span
                        class="input-group-addon flex-grow-width-25 ng-binding">/{{formData.get('tenDonViTinhXuatLe')?.value}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Chiết khấu</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="Discount" id="Discount" class="form-control mb-0 " value="0" tabindex="9"
                        formControlName="discount">
                      <span class="input-group-addon flex-grow-width-25">%</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Chiết khấu theo lợi nhuận</label>
                  <div class="col-sm-8">
                    <input type="checkbox" name="DiscountByRevenue" id="DiscountByRevenue"
                      class="mt-0 form-checkbox check-box " tabindex="20" formControlName="discountByRevenue">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-2 form-group">
                <div class="row">
                  <label class="col-sm-8 control-label">Công khai giá bán</label>
                  <div class="col-sm-4">
                    <input type="checkbox" name="Presentation" id="Presentation" class="mt-0 form-checkbox check-box "
                      tabindex="10" formControlName="presentation">
                  </div>
                </div>
              </div>
              <div class="col-md-4 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Tích điểm</label>
                  <div class="col-sm-8">
                    <input type="checkbox" name="Scorable" id="Scorable" class="mt-0 form-checkbox check-box "
                      tabindex="11" formControlName="scorable">
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Quy đổi số tiền ra 1 điểm</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="MoneyToOneScoreRate" id="MoneyToOneScoreRate" class="form-control mb-0  "
                        value="0" mask="separator" tabindex="21" formControlName="moneyToOneScoreRate"
                        awnum="app-decimal-number">
                      <span class="input-group-addon flex-grow-width-25">/điểm</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="row" [hidden]="checkTab != 'additional-information'">
        <form [formGroup]="formData">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Hàm lượng</label>
                  <div class="col-sm-8">
                    <input type="text" name="HamLuong" id="HamLuong"
                      class="form-control mb-0 ng-pristine ng-valid ng-touched" tabindex="1" formControlName="hamLuong"
                      placeholder="Hàm lượng">
                    <span *ngIf="formData.get('hamLuong')?.invalid && formData.get('hamLuong')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('hamLuong')?.errors?.['maxlength']">
                        Hàm lượng không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Quy cách đóng gói</label>
                  <div class="col-sm-8">
                    <input type="text" name="QuyCachDongGoi" id="QuyCachDongGoi" class="form-control mb-0 " tabindex="2"
                      formControlName="quyCachDongGoi" placeholder="Quy cách đóng gói">
                    <span *ngIf="formData.get('quyCachDongGoi')?.invalid && formData.get('quyCachDongGoi')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('quyCachDongGoi')?.errors?.['maxlength']">
                        Quy cách đóng gói không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Nhà sản xuất</label>
                  <div class="col-sm-8">
                    <input type="text" name="NhaSanXuat" id="NhaSanXuat" class="form-control mb-0 " tabindex="3"
                      formControlName="nhaSanXuat" placeholder="Nhà sản xuất">
                    <span *ngIf="formData.get('nhaSanXuat')?.invalid && formData.get('nhaSanXuat')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('nhaSanXuat')?.errors?.['maxlength']">
                        Nhà sản xuất không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Xuất xứ thương hiệu</label>
                  <div class="col-sm-8">
                    <input type="text" name="XuatXu" id="XuatXu" class="form-control mb-0 " tabindex="4"
                      formControlName="xuatXu" placeholder="Xuất xứ thương hiệu">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Công dụng</label>
                  <div class="col-sm-8">
                    <textarea name="CongDung" id="CongDung" class="form-control " tabindex="5"
                      formControlName="advantages" placeholder="Công dụng"></textarea>
                    <span *ngIf="formData.get('advantages')?.invalid && formData.get('advantages')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('advantages')?.errors?.['maxlength']">
                        Công dụng không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Tác dụng phụ</label>
                  <div class="col-sm-8">
                    <textarea type="text" name="TacDungPhu" id="TacDungPhu" class="form-control " tabindex="6"
                      formControlName="userObject" placeholder="Tác dụng phụ">
                    </textarea>
                    <span *ngIf="formData.get('userObject')?.invalid && formData.get('userObject')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('userObject')?.errors?.['maxlength']">
                        Tác dụng phụ không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Dược động học - Dược lực học</label>
                  <div class="col-sm-8">
                    <textarea name="DuocDongHoc" id="DuocDongHoc" class="form-control " tabindex="7"
                      formControlName="pharmacokinetics" placeholder="Dược động học - Dược lực học"></textarea>
                    <span
                      *ngIf="formData.get('pharmacokinetics')?.invalid && formData.get('pharmacokinetics')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('pharmacokinetics')?.errors?.['maxlength']">
                        Dược động học - Dược lực học không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Hướng dẫn sử dụng</label>
                  <div class="col-sm-8">
                    <textarea type="text" name="HDSD" id="HDSD" class="form-control " tabindex="8"
                      formControlName="userManual" placeholder="Hướng dẫn sử dụng"></textarea>
                    <span *ngIf="formData.get('userManual')?.invalid && formData.get('userManual')?.touched">
                      <span class="text-danger field-validation-error"
                        *ngIf="formData.get('userManual')?.errors?.['maxlength']">
                        Hướng dẫn sử dụng không được vượt quá 1024 kí tự!
                      </span>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Điều kiện bảo quản</label>
                  <div class="col-sm-8">
                    <textarea name="DieuKienBaoQuan" id="DieuKienBaoQuan" class="form-control " tabindex="9"
                      formControlName="storageConditions" placeholder="Điều kiện bảo quản"></textarea>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Vị trí bảo quản</label>
                  <div class="col-sm-8">
                    <textarea type="text" name="ViTriBaoQuan" id="ViTriBaoQuan" class="form-control " tabindex="10"
                      formControlName="storageLocation" placeholder="Vị trí bảo quản"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Chỉ định</label>
                  <div class="col-sm-8">
                    <textarea name="ChiDinh" id="ChiDinh" class="form-control ng-pristine ng-valid ng-touched"
                      tabindex="11" formControlName="chiDinh" placeholder="Chỉ định"></textarea>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Chống chỉ định</label>
                  <div class="col-sm-8">
                    <textarea type="text" name="ChongChiDinh" id="ChongChiDinh" class="form-control " tabindex="12"
                      formControlName="chongChiDinh" placeholder="Chống chỉ định"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Số đăng ký</label>
                  <div class="col-sm-8">
                    <textarea name="SoDangKy" id="SoDangKy" class="form-control " tabindex="13"
                      formControlName="registeredNo" placeholder="Số đăng ký"></textarea>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Lưu ý</label>
                  <div class="col-sm-8">
                    <textarea type="text" name="LuuY" id="LuuY" class="form-control " tabindex="14"
                      formControlName="noted" placeholder="Lưu ý"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Chiết khấu khuyến mại</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <input type="text" name="PromotionalDiscounts" id="PromotionalDiscounts"
                        class="form-control mb-0 ng-pristine ng-valid ng-touched" value="0" tabindex="9"
                        formControlName="promotionalDiscounts">
                      <span class="input-group-addon flex-grow-width-25">%</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Áp dụng chiết khấu khuyến mại</label>
                  <div class="col-sm-8">
                    <input type="checkbox" name="EnablePromotionalDiscounts" id="EnablePromotionalDiscounts"
                      class="mt-0 form-checkbox check-box " tabindex="20" formControlName="enablePromotionalDiscounts">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-6 form-group">
                <div class="row">
                  <label class="col-sm-4 control-label">Mô tả</label>
                  <div class="col-sm-8">
                    <div class="input-group">
                      <textarea name="DescriptionOnWebsite" id="DescriptionOnWebsite"
                        placeholder="Mô tả thông tin thuốc..." class="form-control mb-0 "
                        formControlName="descriptionOnWebsite"></textarea>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6 form-group">
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="row" [hidden]="checkTab != 'replace-together'">
        <!--        <form [formGroup]="formData">-->
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-6">
              <label>Danh sách hàng thay thế</label>
              <div>
                <div class="w-100">
                  <div class="input-group">
                    <ng-select #selectDrug
                               class="w-100"
                               appendTo="body"
                               appearance="outline"
                               [items]="listThuoc$ | async"
                               [typeahead]="searchThuocTerm$"
                               bindLabel="tenThuoc"
                               bindValue="id"
                               [minTermLength]="2"
                               appendTo="body"
                               appearance="outline"
                               placeholder="Tra cứu theo tên, mã, mã vạch..."
                               notFoundText="Không tìm thấy mục nào"
                               (change)="searchThuocTerm$.next(''); onDrugChange($event)">
                      <ng-template ng-label-tmp let-item="item">
                        <span *ngIf="item.maThuoc">{{item.maThuoc}}-{{item.tenThuoc}}</span>
                        <span *ngIf="!item.maThuoc">{{drugDefault.maThuoc}} - {{drugDefault.tenThuoc}}</span>
                      </ng-template>
                      <ng-template ng-option-tmp let-item="item" let-index="index"
                                   let-search="searchTerm">
                                            <span [ngOptionHighlight]="search">{{item.maThuoc}}-{{item.tenThuoc}}-
                                              {{item.tenDonViTinhXuatLe}} - Gián bán : {{item.giaBanLe
                                                |number}}</span>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
              <table class="table table-bordered w-100">
                <tbody>
                  <tr>
                    <th>STT</th>
                    <th>Mã - Tên thuốc</th>
                    <th>#</th>
                  </tr>
                  <tr ng-repeat="i in viewModel.ReplaceGoods" class="ng-scope" *ngFor="let item of dataThayThe, index as i">
                    <td class="ng-binding">{{i + 1}}</td>
                    <td class="ng-binding">{{item.maThuoc}} - {{item.tenThuoc}}</td>
                    <td>
                      <a title="Xóa khỏi danh sách"
                        ng-click="onDelete(1,i); $event.preventDefault(); $event.stopPropagation();"
                        class="btn btn-danger btn-sm">
                        <i class="fa-regular fa-trash"></i>
                      </a>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="col-md-6">
              <label>Danh sách hàng bán kèm</label>
              <div>
                <div class="w-100">
                  <div class="input-group">
                    <ng-select #selectDrug
                               class="w-100"
                               appendTo="body"
                               appearance="outline"
                               [items]="listThuoc$ | async"
                               [typeahead]="searchThuocTerm$"
                               bindLabel="tenThuoc"
                               bindValue="id"
                               [minTermLength]="2"
                               appendTo="body"
                               appearance="outline"
                               placeholder="Tra cứu theo tên, mã, mã vạch..."
                               notFoundText="Không tìm thấy mục nào"
                               (change)="searchThuocTerm$.next(''); onDrugChangeBanKem($event)">
                      <ng-template ng-label-tmp let-item="item">
                        <span *ngIf="item.maThuoc">{{item.maThuoc}}-{{item.tenThuoc}}</span>
                        <span *ngIf="!item.maThuoc">{{drugDefault.maThuoc}} - {{drugDefault.tenThuoc}}</span>
                      </ng-template>
                      <ng-template ng-option-tmp let-item="item" let-index="index"
                                   let-search="searchTerm">
                                            <span [ngOptionHighlight]="search">{{item.maThuoc}}-{{item.tenThuoc}}-
                                              {{item.tenDonViTinhXuatLe}} - Gián bán : {{item.giaBanLe
                                                |number}}</span>
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
              </div>
              <table class="table table-bordered w-100">
                <tbody>
                <tr>
                  <th>STT</th>
                  <th>Mã - Tên thuốc</th>
                  <th>#</th>
                </tr>
                <tr ng-repeat="i in viewModel.ReplaceGoods" class="ng-scope" *ngFor="let item of dataBanKem, index as i">
                  <td class="ng-binding">{{i + 1}}</td>
                  <td class="ng-binding">{{item.maThuoc}} - {{item.tenThuoc}}</td>
                  <td>
                    <a title="Xóa khỏi danh sách"
                       ng-click="onDelete(1,i); $event.preventDefault(); $event.stopPropagation();"
                       class="btn btn-danger btn-sm">
                      <i class="fa-regular fa-trash"></i>
                    </a>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!--        </form>-->
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-default" (click)="closeModal()">Đóng</button>
      <button type="button" class="btn btn-primary" (click)="createUpdate()">{{drugId > 0 ? 'Cập nhật' : 'Thêm
        mới'}}</button>
    </div>
  </div>
</div>
