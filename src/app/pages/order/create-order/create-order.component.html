<div>
    <div>
        <div class="card-bg">
            <h2 class="card-title text-center">
                <b>ĐƠN ĐẶT HÀNG</b>
            </h2>
            <div class="text-center card-desc">
                <div class="card-code">
                    Mã số: <strong>
                        <!-- {{viewModel.OrderNumber}} -->1
                    </strong>
                </div>
                Ngày: <div class="clickable-text daterange-picker">
                    <input type="text" ng-disabled="!isEditing" name="orderDate" id="order-date-id" ng-model="viewModel.OrderDate">
                    <span class="text-link font-weight-bold">
                        <!-- {{viewModel.OrderDate}} -->1/1/2024
                    </span> <span ng-if="viewModel.Id > 0" class="text-link font-weight-bold">
                        <!-- {{viewModel.OrderTime}} -->10:00
                    </span></div>
            </div>
            <div>
                <table class="table borderless table-condensed">
                    <tr>
                        <td style="text-align: left; width:60px;">
                            <label class="control-label">Trạng thái</label>
                        </td>
                        <td style="text-align: left;" width="250px">
                            <select id="ddlOrderStatus" class="form-control mb-0">
                                <option>Đơn tạo mới</option>
                            </select>
                        </td>
                        <td style="width:65px; text-align:right;" ng-if="!viewModel.IsGeneralPharmacy">
                            <label class="control-label">Nhà CC</label>
                        </td>
                        <td style="width:400px; text-align:left;" ng-if="!viewModel.IsGeneralPharmacy">
                           <select class="form-control">
                            <option>NCC A</option>
                           </select>
                        </td>
                    </tr>
                </table>
                <table class="table-condensed table-responsive display dataTable no-footer" 
                style="width:100%; border-collapse:collapse; font-size:14px;">
                    <thead>
                        <tr>
                            <th style="width: 3%;" ng-if="shallDisplayAddDelete()">#</th>
                            <th style="width: 4%;">STT</th>
                            <th>Ảnh</th>
                            <th style="width: 300px;">Mặt Hàng <span> [Mã-Tên]</span> </th>
                            <th style="text-align: center;">
                                <!-- {{getItemQuantityLabel()}} -->Số lượng mua
                            </th>
                            <th style="text-align: center;" ng-if="shallDisplayRealQuantity()">
                                <!-- {{getItemRealQuantityLabel()}} -->Số lượng giao
                            </th>
                            <th style="text-align: right;">Đơn Giá</th>
                            <th style="text-align: center;">Đơn Vị</th>
                                <th style="text-align: center;">Nhóm Hàng</th>
                                <th style="width: 6%; text-align: center;" ng-if="!viewModel.IsGeneralPharmacy && ((viewModel.OrderStatusId == 1 && isEditing) || viewModel.DiffSuppliers)">Nhà CC</th>
                            <th style="text-align:right;" ng-if="viewModel.IsGeneralPharmacy">Tồn</th>
                            <th style="text-align:right;">
                                <!-- {{getItemTotalAmountLabel()}} -->Thành tiền
                            </th>
                        </tr>
                    </thead>
                    <tbody ng-repeat="gridItem in viewModel.OrderItems">
                        <tr style="border-bottom: 1px solid #ccc;" ng-show="shallDisplayItem(gridItem)">
                            <!--Actions-->
                            <td ng-if="shallDisplayAddDelete()">
                                <div ng-if="!gridItem.IsEditingItem">
                                    <a class="delete-drug btn btn-danger" title="Xóa" ng-click="onDelete(gridItem); $event.preventDefault(); $event.stopPropagation();" ng-show="isEditing"><i class="fa-regular fa-trash"></i></a>
                                </div>
                                <div ng-if="gridItem.IsEditingItem">
                                    <a class="btn btn-primary" title="Thêm mới"><i class="fa-regular fa-plus"></i></a>
                                </div>
                            </td>

                            <!--STT-->
                            <td>
                                <a href="#" ng-click="onDrugInfoDetails(gridItem.DrugId); $event.preventDefault(); $event.stopPropagation();" ng-show="!gridItem.IsEditingItem">
                                    <!-- {{gridItem.ItemOrder}} -->1
                                </a>
                            </td>

                            <!--Hình ảnh-->
                            <td>
                                <div ng-if="!gridItem.IsEditingItem">
                                    <a ng-if="gridItem.ImageThumbUrl" data-fancybox="" href="" data-caption="Ảnh sản phẩm">
                                        <img ng-src="" alt="" style="width: 40px; height:40px;" />
                                    </a>
                                </div>
                            </td>

                            <!--Mặt Hàng-->
                            <td>
                                <!-- <input type="text" class="form-control"/> -->
                                <div ng-if="!gridItem.IsEditingItem">
                                    <span class="text-success">
                                        <!-- {{gridItem.DrugCode}}- --> TH01-
                                    </span>
                                    <!-- {{gridItem.DrugName}} -->Thuốc 1
                                </div>
                            </td>

                            <!--Số Lượng-->
                            <td>
                                <div class="input-group-double" ng-if="!canNotEditQuantity()">
                                    <span class="input-group-btn" onclick="event.preventDefault();">
                                        <button class="btn btn-primary" ng-click="onDecreaseQuantity($event, gridItem); $event.preventDefault(); $event.stopPropagation();"><i class="fa-regular fa-minus"></i></button></span>
                                    <input type="text" id="" class="form-control mb-0  mousetrap row-item-quantiy" 
                                    style="width: 100%; text-align:right; font-size:14px;" ng-model="gridItem.Quantity" awnum="app-decimal-number" ng-blur="onLostFocus($event)">
                                    <span class="input-group-btn" onclick="event.preventDefault();"><button class="btn btn-primary" ng-click="onIncreaseQuantity($event, gridItem); $event.preventDefault(); $event.stopPropagation();"><i class="fa-regular fa-plus"></i></button></span>
                                </div>
                                <div ng-if="canNotEditQuantity()" style="text-align: center;">
                                    <span>
                                        <!-- {{gridItem.Quantity | number: 2}} -->1
                                    </span>
                                </div>
                            </td>

                            <!--Số Lượng thực (bên bán)-->
                            <td ng-if="shallDisplayRealQuantity()">
                                <div class="input-group-double" ng-if="!canNotEditRealQuantity()">
                                    <span class="input-group-btn" onclick="event.preventDefault();"><button class="btn btn-primary" ng-disabled="!permittedFields.Order_EditQuantity" ng-click="onDecreaseRealQuantity($event, gridItem); $event.preventDefault(); $event.stopPropagation();"><i class="fa-regular fa-minus"></i></button></span>
                                    <input type="text" id="" class="form-control mb-0 mousetrap row-item-quantiy"
                                           style="width: 100%; text-align:right; font-size:14px;"
                                           ng-model="gridItem.RealQuantity" awnum="app-decimal-number" ng-blur="onLostFocus($event)"
                                           ng-readonly="!permittedFields.Order_EditQuantity">
                                    <span class="input-group-btn" onclick="event.preventDefault();">
                                        <button class="btn btn-primary" ng-disabled="!permittedFields.Order_EditQuantity" ng-click="onIncreaseRealQuantity($event, gridItem); $event.preventDefault(); $event.stopPropagation();"><i class="fa-regular fa-plus"></i></button></span>
                                </div>
                                <div ng-if="canNotEditRealQuantity()" class="number-value" style="text-align: center;">
                                    <!-- {{gridItem.RealQuantity | number:0}} -->1
                                </div>
                            </td>

                            <!--Giá Đặt-->
                            <td>
                                <div ng-if="!canNotEditPrice()">
                                    <div class="input-group" ng-if="gridItem.DrugId > 0">
                                        <input type="text" ng-readonly="!permittedFields.Order_EditPrice" class="form-control mousetrap" style="width: 100%; text-align:right; font-size:14px;" ng-model="gridItem.Price" awnum="app-decimal-number" ng-blur="onLostFocus($event)">
                                    </div>
                                </div>
                                <div ng-if="canNotEditPrice()" class="number-value" style="text-align: right;">
                                    <!-- {{gridItem.Price | number:0}} -->1.000
                                </div>
                            </td>

                            <!--Đơn Vị-->
                            <td>
                                <div>
                                    <div ng-if="!canNotEditUnit()">
                                        <select class="form-control"
                                                ng-model="gridItem.SelectedUnitId"
                                                ng-options="item.UnitId as item.UnitName for item in gridItem.Units"
                                                ng-change="onUnitChanged(gridItem)" style="width:100%;"></select>
                                    </div>
                                    <div ng-if="canNotEditUnit()" style="text-align: center;">
                                        <span>
                                            <!-- {{getUnitName(gridItem)}} --> hộp
                                        </span>
                                    </div>
                                </div>
                            </td>

                            <!--Nhóm Hàng-->
                            <td style="text-align: left;">
                                <div ng-if="gridItem.DrugId > 0">
                                    <!-- {{gridItem.GroupName}} -->Nhóm 1
                                </div>
                                <div ng-if="gridItem.DrugId == 0 && !gridItem.IsEditingItem">
                                    Hàng nhặt
                                </div>
                                <div ng-if="gridItem.DrugId < 0">
                                    N/A
                                </div>
                            </td>

                            <!--Nhà CC-->
                            <td ng-if="!viewModel.IsGeneralPharmacy && ((viewModel.OrderStatusId == 1 && isEditing) || viewModel.DiffSuppliers)" style="text-align: center;">
                                <div ng-if="gridItem.DrugId > 0">
                                    <a href="#" ng-click="onStoreDetails(gridItem); $event.preventDefault(); $event.stopPropagation();" title="">
                                        <!-- {{gridItem.SupplierStoreCode}} -->0010
                                    </a>
                                </div>
                                <div ng-if="gridItem.DrugId < 0">
                                    N/A
                                </div>
								<div ng-if="gridItem.DrugId == 0 && !gridItem.IsEditingItem">
									Mặc định
							    </div>
                            </td>

                            <!--Tồn-->
                            <td ng-if="viewModel.IsGeneralPharmacy">
                                <div class="number-value">
                                    <!-- {{gridItem.RemainQuantity | number:0}} -->1
                                </div>
                            </td>

                            <!--Thành Tiền-->
                            <td>
                                <div class="number-value">
                                    <strong>
                                        <!-- {{gridItem.TotalAmount | number:0}} -->1.000
                                    </strong>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <div class="mt-3 mb-3 d-flex align-items-center gap-10">
                    <span style="margin-right: 30px;"><strong>Tổng số tiền: </strong><span>
                        <!-- {{getOrderTotalAmount() | number:0}} -->1.000
                    </span></span>
                    <span><strong>Chiết khấu trả sau: </strong><span>
                        <!-- {{getOrderDiscountAmount() | number:0}} --> 1.000
                    </span></span>
                </div>

                <table class="table borderless table-condensed" style="padding: 5px;">
                    <tr ng-if="!viewModel.IsGeneralPharmacy">
                        <td style="text-align: left;width:113px;"><label class="control-label">Ghi chú</label></td>
                        <td style="text-align: left;">
                            <textarea ng-disabled="!isEditing || viewModel.IsGeneralPharmacy" class="form-control mb-0 w-100"  ng-model="viewModel.Description"></textarea>
                        </td>
                    </tr>
                    <tr ng-if="!viewModel.IsGeneralPharmacy && viewModel.HasSupplierDescription">
                        <td style="text-align: left;width:113px;"><label class="control-label">Ghi chú (bên bán)</label></td>
                        <td style="text-align: left;">
                            <textarea ng-disabled="true" class="form-control mb-0 w-100"  ng-model="viewModel.SupplierDescription"></textarea>
                        </td>
                    </tr>
                    <tr ng-if="viewModel.IsGeneralPharmacy">
                        <td style="text-align: left;width:113px;"><label class="control-label">Ghi chú (bên mua)</label></td>
                        <td style="text-align: left;">
                            <textarea type="text" ng-disabled="true" class="form-control mb-0 w-100"  ng-model="viewModel.Description"></textarea>
                        </td>
                    </tr>
                    <tr ng-if="viewModel.IsGeneralPharmacy">
                        <td style="text-align: left;width:113px;"><label class="control-label">Ghi chú (bên bán)</label></td>
                        <td style="text-align: left;">
                            <textarea ng-disabled="!isEditing" class="form-control mb-0 w-100"  ng-model="viewModel.SupplierDescription"></textarea>
                        </td>
                    </tr>
                </table>
                <div class="d-flex justify-content-center align-items-center gap-10 mt-3 mb-3">
                    <input type="button" value="Quay lại" class="btn btn-default" ng-click="onBack(); $event.preventDefault(); $event.stopPropagation();" />
                    <input type="submit" value="Ghi đơn" ng-if="viewModel.RecordStatusId != 2 && isEditing" class="btn btn-primary" ng-click="saveOrder(); $event.preventDefault(); $event.stopPropagation();" />
                    <span class="gap-10 d-flex" ng-if="!viewModel.IsGeneralPharmacy">
                        <a ng-if="viewModel.canEditOrder"
                            class="btn btn-primary"
                            href="">
                            Sửa
                        </a>
                        <input ng-if="viewModel.canDeleteOrder" type="button" value="Xóa" class="btn btn-danger" ng-click="onDeleteOrder(); $event.preventDefault(); $event.stopPropagation();" />
                        <input ng-if="viewModel.canSendOrder" type="button" value="Gửi đơn" class="btn btn-default" ng-click="onSendOrder(); $event.preventDefault(); $event.stopPropagation();" />
                    </span>
                    <span ng-if="viewModel.canPrintOrder">
                        <input type="button" value="In" class="btn btn-default" ng-click="onPrintOrder(); $event.preventDefault(); $event.stopPropagation();" />
                    </span>
                    <span ng-if="viewModel.IsGeneralPharmacy">
                        <a ng-if="viewModel.canHandleOrder"
                           class="btn btn-primary"
                           href="">
                            Xử lý
                        </a>
                        <input ng-if="viewModel.canFinishOrder" type="button" value="Hoàn thành" class="btn btn-default" ng-click="onFinishOrder(); $event.preventDefault(); $event.stopPropagation();" />
                        <input value="Tạo phiếu nhập" type="button" ng-if="viewModel.RecordStatusId != 2 && isEditing && permittedFields.ReceiptNote_Create" class="btn btn-primary" ng-click="onCreateReceiptNote(); $event.preventDefault(); $event.stopPropagation();" />
                        <input ng-if="viewModel.canCancelOrder" type="button" value="Hủy đơn" class="btn btn-danger" ng-click="onCancelOrder(); $event.preventDefault(); $event.stopPropagation();" />
                    </span>
                </div>

                <table class="table borderless table-condensed" ng-if="viewModel.TaskMode!=1">
                    <tr>
                        <td></td>
                        <td style="text-align:right;" ng-if="viewModel.TaskMode!=1">
                            <span class="control-label">[<strong>Người lập:</strong> 
                                <!-- {{viewModel.CreatedBy}} -->Nguyễn Văn A
                                ]</span>
                        </td>
                        <td style="text-align:right;" ng-if="viewModel.TaskMode!=1">
                            <span class="control-label">[<strong>Ngày lập:</strong> 
                                <!-- {{viewModel.CreatedDate |appDate}} -->2/2/2024
                                ]</span>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>